{% extends "base.html" %}

{% block title %}Cap√≠tulo 2 - Sistemas de Ecuaciones{% endblock %}

{% block header_title %}Cap√≠tulo 2: Sistemas de Ecuaciones Lineales{% endblock %}
{% block header_subtitle %}M√©todos iterativos: Jacobi, Gauss-Seidel y SOR{% endblock %}

{% block content %}
<div class="metodos-container">
    <div class="metodos-sidebar">
        <h3>M√©todos Disponibles</h3>
        <button class="metodo-btn active" onclick="cambiarMetodo('jacobi')">Jacobi</button>
        <button class="metodo-btn" onclick="cambiarMetodo('gauss-seidel')">Gauss-Seidel</button>
        <button class="metodo-btn" onclick="cambiarMetodo('sor')">SOR</button>
        <hr style="margin: 20px 0; border: 1px solid #e0e0e0;">
        <button class="metodo-btn" onclick="cambiarMetodo('informe-cap2')" style="background: #27ae60; color: white;">üìä Generar Informe</button>
    </div>

    <div class="metodo-content">
        <!-- Ayuda General -->
        <div class="ayuda-general-banner">
            <button class="ayuda-toggle" onclick="toggleAyudaGeneral()">
                Formato de Entrada (Click para ayuda)
            </button>
            <div id="ayuda-general-content" class="ayuda-general-content" style="display: none;">
                <h3>Guia de Formato de Entrada - Capitulo 2</h3>

                <div class="ayuda-section">
                    <h4>Matriz A (Coeficientes del Sistema)</h4>
                    <p><strong>Formato:</strong> Separa filas con ";" y elementos con ","</p>
                    <table class="syntax-table">
                        <tr><th>Sistema</th><th>Formato</th></tr>
                        <tr>
                            <td>2x2</td>
                            <td><code>10,1;2,10</code></td>
                        </tr>
                        <tr>
                            <td>3x3</td>
                            <td><code>10,1,1;2,10,1;2,2,10</code></td>
                        </tr>
                        <tr>
                            <td>4x4</td>
                            <td><code>5,1,0,0;1,5,1,0;0,1,5,1;0,0,1,5</code></td>
                        </tr>
                    </table>
                    <p class="tip"><strong>Restriccion:</strong> Matrices de 2x2 hasta 7x7. La matriz debe ser cuadrada.</p>
                </div>

                <div class="ayuda-section">
                    <h4>Vector b (Terminos Independientes)</h4>
                    <p><strong>Formato:</strong> Separa elementos con ","</p>
                    <table class="syntax-table">
                        <tr><th>Dimension</th><th>Ejemplo</th></tr>
                        <tr><td>2 elementos</td><td><code>11,12</code></td></tr>
                        <tr><td>3 elementos</td><td><code>12,13,14</code></td></tr>
                        <tr><td>4 elementos</td><td><code>6,6,6,6</code></td></tr>
                    </table>
                    <p class="tip"><strong>Importante:</strong> El vector b debe tener el mismo numero de elementos que filas en la matriz A.</p>
                </div>

                <div class="ayuda-section">
                    <h4>Vector Inicial x0 (Opcional)</h4>
                    <p><strong>Formato:</strong> Separa elementos con ","</p>
                    <p><strong>Por defecto:</strong> Si no se especifica, se usa el vector cero (0,0,0...)</p>
                    <p><strong>Ejemplos:</strong></p>
                    <ul>
                        <li><code>0,0,0</code> - Vector cero (predeterminado)</li>
                        <li><code>1,1,1</code> - Vector de unos</li>
                        <li><code>0.5,0.5,0.5</code> - Valores personalizados</li>
                    </ul>
                </div>

                <div class="ayuda-section">
                    <h4>Tolerancia y Error</h4>
                    <div class="info-box">
                        <p><strong>Como se calcula el error:</strong></p>
                        <p>Todos los metodos usan la <strong>norma infinito</strong>:</p>
                        <p style="text-align: center; font-size: 1.1em; margin: 10px 0;">
                            <code>Error = ||x<sup>(n)</sup> - x<sup>(n-1)</sup>||<sub>‚àû</sub></code>
                        </p>
                        <p>Esto mide la diferencia maxima entre iteraciones sucesivas.</p>
                    </div>
                    <p><strong>Ejemplos de tolerancia:</strong></p>
                    <ul>
                        <li><code>1e-6</code> = 0.000001 (precision alta)</li>
                        <li><code>1e-10</code> = 0.0000000001 (precision muy alta)</li>
                        <li><code>0.0001</code> = 0.0001 (precision media)</li>
                    </ul>
                </div>

                <div class="ayuda-section">
                    <h4>Factor de Relajacion w (Solo para SOR)</h4>
                    <p><strong>Rango valido:</strong> 0 < w < 2</p>
                    <table class="syntax-table">
                        <tr><th>Valor</th><th>Tipo</th><th>Descripcion</th></tr>
                        <tr><td>w < 1</td><td>Subrelajacion</td><td>Convergencia mas lenta pero mas estable</td></tr>
                        <tr><td>w = 1</td><td>Gauss-Seidel</td><td>Equivalente al metodo Gauss-Seidel</td></tr>
                        <tr><td>w > 1</td><td>Sobrerelajacion</td><td>Convergencia mas rapida (si converge)</td></tr>
                    </table>
                    <p class="tip"><strong>Valor recomendado:</strong> <code>1.5</code> (buena opcion inicial)</p>
                </div>

                <div class="ayuda-section">
                    <h4>Convergencia de los Metodos</h4>
                    <div class="info-box">
                        <p><strong>Radio Espectral œÅ(T):</strong></p>
                        <p>Los resultados muestran el radio espectral de la matriz de iteracion.</p>
                        <ul>
                            <li><strong>œÅ(T) < 1</strong> ‚Üí El metodo converge (garantizado)</li>
                            <li><strong>œÅ(T) ‚â• 1</strong> ‚Üí El metodo puede no converger</li>
                        </ul>
                        <p class="tip"><strong>Diagonal dominante:</strong> Si la matriz es diagonalmente dominante,
                        todos los metodos (Jacobi, Gauss-Seidel, SOR) convergen garantizadamente.</p>
                    </div>
                </div>

                <div class="ayuda-section">
                    <h4>Ejemplos Completos</h4>
                    <p><strong>Sistema 3x3 diagonal dominante:</strong></p>
                    <ul>
                        <li>Matriz A: <code>10,1,1;2,10,1;2,2,10</code></li>
                        <li>Vector b: <code>12,13,14</code></li>
                        <li>Tolerancia: <code>1e-6</code></li>
                        <li>Iteraciones: <code>100</code></li>
                    </ul>

                    <p><strong>Sistema 4x4 tridiagonal:</strong></p>
                    <ul>
                        <li>Matriz A: <code>4,1,0,0;1,4,1,0;0,1,4,1;0,0,1,4</code></li>
                        <li>Vector b: <code>5,5,5,5</code></li>
                        <li>Tolerancia: <code>1e-8</code></li>
                        <li>Iteraciones: <code>200</code></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Jacobi -->
        <div id="jacobi" class="metodo-panel active">
            <h2>M√©todo de Jacobi</h2>
            <form id="form-jacobi">
                <div class="form-group">
                    <label>Matriz A (coeficientes):</label>
                    <input type="text" name="matriz" value="10,1,1;2,10,1;2,2,10" required>
                    <small>Formato: fila1;fila2;fila3 (Ej: 10,1,1;2,10,1;2,2,10)</small>
                </div>
                <div class="form-group">
                    <label>Vector b:</label>
                    <input type="text" name="vector_b" value="12,13,14" required>
                    <small>Formato: b1,b2,b3 (Ej: 12,13,14)</small>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Vector inicial x0 (opcional):</label>
                        <input type="text" name="x0" placeholder="0,0,0">
                        <small>Dejar vac√≠o para usar vector cero</small>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Tolerancia:</label>
                        <input type="text" name="tol" placeholder="1e-6" required>
                        <small>Ejemplos: 1e-6, 1e-10, 0.0001 (Error calculado con norma infinito)</small>
                    </div>
                    <div class="form-group">
                        <label>Iteraciones m√°ximas:</label>
                        <input type="number" name="niter" value="100" required>
                    </div>
                </div>
                <button type="button" class="btn btn-primary" onclick="ejecutarMetodo('jacobi')">Ejecutar</button>
            </form>
            <div id="loading-jacobi" class="loading"><div class="spinner"></div></div>
            <div id="resultados-jacobi" class="results-section"></div>
            <div id="grafica-jacobi" class="grafica-container"></div>
        </div>

        <!-- Gauss-Seidel -->
        <div id="gauss-seidel" class="metodo-panel">
            <h2>M√©todo de Gauss-Seidel</h2>
            <form id="form-gauss-seidel">
                <div class="form-group">
                    <label>Matriz A:</label>
                    <input type="text" name="matriz" value="10,1,1;2,10,1;2,2,10" required>
                </div>
                <div class="form-group">
                    <label>Vector b:</label>
                    <input type="text" name="vector_b" value="12,13,14" required>
                </div>
                <div class="form-group">
                    <label>Vector inicial x0 (opcional):</label>
                    <input type="text" name="x0" placeholder="0,0,0">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Tolerancia:</label>
                        <input type="text" name="tol" placeholder="1e-6" required>
                        <small>Ejemplos: 1e-6, 1e-10, 0.0001 (Error calculado con norma infinito)</small>
                    </div>
                    <div class="form-group">
                        <label>Iteraciones m√°ximas:</label>
                        <input type="number" name="niter" value="100" required>
                    </div>
                </div>
                <button type="button" class="btn btn-primary" onclick="ejecutarMetodo('gauss-seidel')">Ejecutar</button>
            </form>
            <div id="loading-gauss-seidel" class="loading"><div class="spinner"></div></div>
            <div id="resultados-gauss-seidel" class="results-section"></div>
            <div id="grafica-gauss-seidel" class="grafica-container"></div>
        </div>

        <!-- SOR -->
        <div id="sor" class="metodo-panel">
            <h2>M√©todo SOR (Successive Over-Relaxation)</h2>
            <div class="help-box">
                <p><strong>Factor w:</strong> 0 < w < 2</p>
                <ul>
                    <li>w < 1: Subrelajaci√≥n</li>
                    <li>w = 1: Gauss-Seidel est√°ndar</li>
                    <li>w > 1: Sobrerelajaci√≥n (m√°s r√°pido)</li>
                </ul>
                <p>Valor recomendado: 1.5</p>
            </div>
            <form id="form-sor">
                <div class="form-group">
                    <label>Matriz A:</label>
                    <input type="text" name="matriz" value="10,1,1;2,10,1;2,2,10" required>
                </div>
                <div class="form-group">
                    <label>Vector b:</label>
                    <input type="text" name="vector_b" value="12,13,14" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Vector inicial x0 (opcional):</label>
                        <input type="text" name="x0" placeholder="0,0,0">
                    </div>
                    <div class="form-group">
                        <label>Factor de relajaci√≥n w:</label>
                        <input type="number" step="any" name="w" value="1.5" required>
                        <small>Debe estar entre 0 y 2</small>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Tolerancia:</label>
                        <input type="text" name="tol" placeholder="1e-6" required>
                        <small>Ejemplos: 1e-6, 1e-10, 0.0001 (Error calculado con norma infinito)</small>
                    </div>
                    <div class="form-group">
                        <label>Iteraciones m√°ximas:</label>
                        <input type="number" name="niter" value="100" required>
                    </div>
                </div>
                <button type="button" class="btn btn-primary" onclick="ejecutarMetodo('sor')">Ejecutar</button>
            </form>
            <div id="loading-sor" class="loading"><div class="spinner"></div></div>
            <div id="resultados-sor" class="results-section"></div>
            <div id="grafica-sor" class="grafica-container"></div>
        </div>

        <!-- Panel de Informe Comparativo Cap 2 -->
        <div id="informe-cap2" class="metodo-panel">
            <h2>üìä Informe Comparativo de M√©todos</h2>
            <div class="help-box">
                <h4>¬øQu√© hace el informe?</h4>
                <p>Ejecuta los 3 m√©todos (Jacobi, Gauss-Seidel y SOR) con la misma matriz y compara:</p>
                <ul>
                    <li>N√∫mero de iteraciones hasta convergencia</li>
                    <li>Error final alcanzado</li>
                    <li>Radio espectral de cada m√©todo</li>
                    <li>Tiempo de ejecuci√≥n</li>
                </ul>
                <p><strong>Resultado:</strong> Identifica cu√°l m√©todo convergi√≥ m√°s r√°pido y con menor error.</p>
            </div>

            <form id="form-informe-cap2">
                <div class="form-group">
                    <label>Matriz A (coeficientes):</label>
                    <input type="text" name="matriz" value="10,1,1;2,10,1;2,2,10" required>
                    <small>Formato: fila1;fila2;fila3 - Ejemplo: 10,1,1;2,10,1;2,2,10</small>
                </div>

                <div class="form-group">
                    <label>Vector b (t√©rminos independientes):</label>
                    <input type="text" name="vector_b" value="12,13,14" required>
                    <small>Formato: b1,b2,b3 - Ejemplo: 12,13,14</small>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Vector inicial x0 (opcional):</label>
                        <input type="text" name="x0" placeholder="0,0,0">
                        <small>Si vac√≠o, usa vector cero</small>
                    </div>
                    <div class="form-group">
                        <label>Factor w para SOR:</label>
                        <input type="number" step="any" name="w" value="1.5" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Tolerancia:</label>
                        <input type="text" name="tol" placeholder="1e-6" required>
                        <small>Ejemplos: 1e-6, 1e-10, 0.0001 (Error calculado con norma infinito)</small>
                    </div>
                    <div class="form-group">
                        <label>Iteraciones m√°ximas:</label>
                        <input type="number" name="niter" value="100" required>
                    </div>
                </div>

                <button type="button" class="btn btn-success" onclick="generarInformeCap2()">üöÄ Generar Informe Comparativo</button>
            </form>

            <div id="loading-informe-cap2" class="loading"><div class="spinner"></div></div>
            <div id="resultados-informe-cap2" class="results-section"></div>
        </div>

    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/cap2.js') }}"></script>
{% endblock %}
